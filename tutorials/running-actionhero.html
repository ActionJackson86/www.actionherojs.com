<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="57x57" href="/static/images/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/images/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/images/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/images/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/images/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/images/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/images/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/images/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/images/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/images/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/images/icons/favicon-16x16.png"/><link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css"/><link rel="stylesheet" type="text/css" href="/static/css/bebasNeue.css"/><link rel="stylesheet" type="text/css" href="/static/css/animations.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Roboto:100,300,400,500,700,900" rel="stylesheet"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Actionhero</title><script src="/static/js/googleAnalytics.js"></script><meta name="next-head-count" content="21"/><link rel="preload" href="/_next/static/chunks/main-34725f5a99cb2b2b6f00.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.a5d4ffe593e18b49243e.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.94d1ccb9dee116719961.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7d0481f4467570ea8ca6.js" as="script"/><link rel="preload" href="/_next/static/chunks/dd05285286c593a0e6da2f584467d9517f5816b2.be19a4f843a12596b98d.js" as="script"/><link rel="preload" href="/_next/static/chunks/27270cb085e17e8e99404fc0284c05b5fb1bb558.1923d1b6e48e3134e628.js" as="script"/><link rel="preload" href="/_next/static/chunks/e75431a1bdcb89b14e100a4a4bb0858c3732af66.b4fa2937edb4092f8c40.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/tutorials/%5Bname%5D-e4f5bf03c6c5960f3180.js" as="script"/></head><body><div id="__next"><div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><header style="background-color:#2F5266"><div class="container"><nav style="background-color:#2F5266;padding-top:5px;margin-bottom:0;border:0" class="navbar navbar-expand-lg navbar-light"><span class="navbar-brand"><a style="padding-top:0;margin-bottom:15px"><img src="/static/images/actionhero-logo-header-wordmark.svg" style="padding-top:14px;padding-bottom:20px"/></a></span><button aria-controls="basic-navbar-nav" type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="basic-navbar-nav"><div class="mr-auto navbar-nav"><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="/why" data-rb-event-key="/why" class="nav-link">Why Actionhero?</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="/downloads" data-rb-event-key="/downloads" class="nav-link">Downloads</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="/tutorials" data-rb-event-key="/tutorials" class="nav-link">Tutorials</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="https://docs.actionherojs.com" data-rb-event-key="https://docs.actionherojs.com" class="nav-link">Docs</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="plugins" data-rb-event-key="plugins" class="nav-link">Plugins</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="community" data-rb-event-key="community" class="nav-link">Community</a><a style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;border-bottom:none;margin-right:20px" href="https://actionherojs.threadless.com" data-rb-event-key="https://actionherojs.threadless.com" class="nav-link">Shop</a></div><div class="d-none d-xl-block navbar-nav"><div class="d-none d-lg-block"><a style="text-decoration:none" href="/get-started"><button style="font-family:Roboto, sans-serif;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;font-weight:300;margin-bottom:0;margin-left:10px;margin-right:10px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Get Started</button></a></div></div></div></nav></div></header></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><div style="background-color:#FBF9E4;color:#2F5266;font-weight:200;padding:50px"><div class="container"><div class="row"><div style="text-align:center" class="col-md-3"><img src="/static/images/ops-tools.svg"/></div><div style="text-align:center" class="col-md-6"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><br/>Running-actionhero</h1></div><div class="col-md-3"></div></div></div></div><div style="height:183px;background:url(&quot;/static/images/clouds-white.svg&quot;) no-repeat center #FBF9E4"></div><div style="padding-bottom:100px" class="container"><div class="row"><div id="_top"></div><div id="docPageContent" class="col-md-12"><div id="tutorialPageContent" class="row"><div class="col-md-9"><div><div id="Server.ts"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Server.ts</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>Actionhero v22 removes the built-in <code>actionhero start</code> and <code>actionhero start cluster</code> commands, and adds a single <code>server.ts</code> entrypoint for your applications. We are also removing support for <code>boot.ts|js</code>.</p><p>For years, Actionhero has shipped with a robust runtime solution, handling graceful restarts, clustering, and more... however. as the node.js ecosystem has matured, the community has:</p><ol><li>Created excellent process management tools, like <a href="https://pm2.keymetrics.io/">PM2</a> which handle running and monitoring your processes, including integration with OS process managers</li><li>Moved to serverless/PASS/Docker deployments which prefer to mange the running of the application directly.</li></ol><p>To better integrate with the above, Actionhero will now run from a new <code>server.ts</code> file, which will be required in your project @ <code>/src/server.ts</code>:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span style="color:#954121">import</span><span> { Process } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&quot;actionhero&quot;</span><span>;
</span>
<span></span><span style="color:#408080;font-style:italic">// load any custom code, configure the env, as needed</span><span>
</span>
<span></span><span style="color:#954121">async</span><span> </span><span class="hljs-function" style="color:#954121">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#458;font-weight:bold">main</span><span class="hljs-function">(</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#408080;font-style:italic">// create a new actionhero process</span><span>
</span><span>  </span><span style="color:#954121">const</span><span> app = </span><span style="color:#954121">new</span><span> Process();
</span>
<span>  </span><span style="color:#408080;font-style:italic">// handle unix signals and uncaught exceptions &amp; rejections</span><span>
</span>  app.registerProcessSignals();
<!-- -->
<span>  </span><span style="color:#408080;font-style:italic">// start the app!</span><span>
</span><span>  </span><span style="color:#408080;font-style:italic">// you can pass custom configuration to the process as needed</span><span>
</span><span>  </span><span style="color:#954121">await</span><span> app.start();
</span>}
<!-- -->
<!-- -->main();
</code></pre><p>When developing, there is no change to your workflow:</p><ul><li><code>npm run dev</code> will continue to hot-compile your typescript code and run it.</li><li><code>npm run build</code> will compile your TS into JS</li><li><code>npm start</code> will now run your <code>./dist/server.js</code> instead of running <code>./node_modules/.bin/actoinhero</code></li></ul><p>This change should also make it easier to distribute your actionhero projects as you can modify a base config collection from this file, and you can use tools like <a href="https://github.com/zeit/pkg">pkg</a> to compile your projects.</p><p>Now that we have this single entrypoint for your applications, we no longer need <code>boot.js|ts</code>. You can now directly run any setup code you need, modify the environment, etc directly in <code>server.ts</code>.</p><div><div id="The Actionhero Binary"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">The Actionhero Binary</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>Actionhero also includes an optional binary which can help you with lifecycle tasks, like generating a new project, actions, tasks, and more. The help for this binary is as follows:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span>--------------------------------------
</span>Actionhero COMMAND &gt;&gt; help
<!-- -->--------------------------------------
<span>Actionhero - A multi-transport node.js API Server </span><span style="color:#954121">with</span><span> integrated cluster capabilities and delayed tasks
</span>
<!-- -->Binary options:
<!-- -->
<!-- -->* actions list
<span>* </span><span style="color:#0086b3">console</span><span>
</span>* generate
<!-- -->* generate action
<!-- -->* generate cli
<!-- -->* generate initializer
<!-- -->* generate plugin
<!-- -->* generate server
<!-- -->* generate task
<!-- -->* help
<!-- -->* task enqueue
<!-- -->* version
<!-- -->
<span></span><span class="hljs-attr">Descriptions</span><span>:
</span>
<!-- -->* actions list
<span>  </span><span class="hljs-attr">description</span><span>: I will list the actions defined on </span><span style="color:#0086b3">this</span><span> server
</span>
<span>* </span><span style="color:#0086b3">console</span><span>
</span><span>  </span><span class="hljs-attr">description</span><span>: start an interactive REPL session </span><span style="color:#954121">with</span><span> the api object </span><span style="color:#954121">in</span><span>-scope
</span>
<!-- -->* generate
<span>  </span><span class="hljs-attr">description</span><span>: will prepare an empty directory </span><span style="color:#954121">with</span><span> a template Actionhero project
</span>
<!-- -->* generate action
<span>  </span><span class="hljs-attr">description</span><span>: generate a </span><span style="color:#954121">new</span><span> action
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate action --name=[name] --description=[description]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->    [description]
<span>      </span><span class="hljs-attr">default</span><span>: an Actionhero action
</span>
<!-- -->* generate cli
<span>  </span><span class="hljs-attr">description</span><span>: generate a </span><span style="color:#954121">new</span><span> cli command
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate cli --name=[name]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->    [description] (optional)
<span>      </span><span class="hljs-attr">default</span><span>: an Actionhero cli command
</span>    [example] (optional)
<span>      </span><span class="hljs-attr">default</span><span>: Actionhero command --option=yes
</span>
<!-- -->* generate initializer
<span>  </span><span class="hljs-attr">description</span><span>: generate a </span><span style="color:#954121">new</span><span> initializer
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate initializer --name=[name] --loadPriority=[p] --startPriority=[p] --stopPriority=[p]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->    [loadPriority]
<span>      </span><span class="hljs-attr">default</span><span>: </span><span style="color:#40a070">1000</span><span>
</span>    [startPriority]
<span>      </span><span class="hljs-attr">default</span><span>: </span><span style="color:#40a070">1000</span><span>
</span>    [stopPriority]
<span>      </span><span class="hljs-attr">default</span><span>: </span><span style="color:#40a070">1000</span><span>
</span>
<!-- -->* generate plugin
<span>  </span><span class="hljs-attr">description</span><span>: generate the structure </span><span style="color:#954121">of</span><span> a </span><span style="color:#954121">new</span><span> Actionhero plugin </span><span style="color:#954121">in</span><span> an empty directory
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate plugin
</span>
<!-- -->* generate server
<span>  </span><span class="hljs-attr">description</span><span>: generate a </span><span style="color:#954121">new</span><span> server
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate server --name=[name]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->
<!-- -->* generate task
<span>  </span><span class="hljs-attr">description</span><span>: generate a </span><span style="color:#954121">new</span><span> task
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero generate task --name=[name] --description=[description] --scope=[scope] --frequency=[frequency]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->    [queue]
<!-- -->    [description]
<span>      </span><span class="hljs-attr">default</span><span>: an Actionhero task
</span>    [frequency]
<!-- -->
<!-- -->* help
<span>  </span><span class="hljs-attr">description</span><span>: get actionhero CLI help; will display </span><span style="color:#0086b3">this</span><span> </span><span style="color:#0086b3">document</span><span>
</span>
<!-- -->* task enqueue
<span>  </span><span class="hljs-attr">description</span><span>: enqueue a defined task into your Actionhero cluster
</span><span>  </span><span class="hljs-attr">example</span><span>: Actionhero task enqueue --name=[taskName] --args=[</span><span style="color:#0086b3">JSON</span><span>-formatted args]
</span><span>  </span><span class="hljs-attr">inputs</span><span>:
</span>    [name]
<!-- -->    [args] (optional)
<!-- -->    [params] (optional)
<!-- -->
<!-- -->* version
<span>  </span><span class="hljs-attr">description</span><span>: </span><span style="color:#954121">return</span><span> the Actionhero version within </span><span style="color:#0086b3">this</span><span> project</span></code></pre><div><div id="Environments and Config"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Environments and Config</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>By default, Actionhero will use the settings found in the <code>exports.default</code> blocks in <code>/config/</code>. However, you can set environment-specific overrides or changes. Actionhero inspects <code>process.env.NODE_ENV</code> to load up runtime configuration overrides from <code>exports.#{env}</code> blocks in your configuration files. This is the recommended way to have separate settings for staging and production.</p><p>The load order of configs is:</p><ul><li>default values in <code>/config</code></li><li>environment-specific values in <code>/config</code></li><li>options passed in to boot with <code>Actionhero.start({configChanges: configChanges})</code></li></ul><p>You can <code>{configChanges: {}}</code> to a new Actionhero.Process&#x27; <code>start</code> or <code>initialize</code> methods. This can be helpful when creating tests. When using CLI commands, you can also set <code>process.env.configChanges</code> or pass <code>--configChanges</code> on the command line. In these cases, <code>configChanges</code> should be stringified JSON.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span>// from ./config/namespace.js
</span><span></span><span style="color:#0086b3">export</span><span> const</span><span style="color:#0086b3"> DEFAULT </span><span>= {
</span>  namespace: function(api) {
<!-- -->    return {
<span>      enabled: </span><span style="color:#954121">true</span><span>,
</span><span>      safe: </span><span style="color:#954121">false</span><span>
</span>    };
<!-- -->  }
<!-- -->};
<!-- -->
<span></span><span style="color:#0086b3">export</span><span> const production = {
</span>  namespace: function(api) {
<!-- -->    return {
<span>      safe: </span><span style="color:#954121">true</span><span>
</span>    };
<!-- -->  }
<!-- -->};
</code></pre><p>In the example above, we are defining <code>config.namespace.enabled</code> and <code>config.namespace.safe</code>. In all environments (NODE_ENV) <code>config.namespace.enabled = true</code> Only in production would <code>config.namespace.safe = true</code>, it is <code>false</code> everywhere else.</p><div><div id="Signals"><br/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="font-weight:300;font-size:36px">Signals</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/></div></div><p>If your <code>server.ts</code> has used <code>app.registerProcessSignals()</code>, you should be ready to handle the most common unix signals:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff"><code><span>  /**
</span>   * Register listeners for process signals and uncaught exceptions &amp; rejections.
<!-- -->   * Try to gracefully shut down when signaled to do so
<!-- -->   */
<!-- -->  registerProcessSignals() {
<!-- -->    function awaitHardStop() {
<!-- -->      const timeout = process.env.ACTIONHERO_SHUTDOWN_TIMEOUT
<span>        ? parseInt(</span><span style="color:#000080;font-weight:normal">process.env.ACTIONHERO_SHUTDOWN_TIMEOUT</span><span>)
</span><span>        : </span><span style="color:#40a070">1000</span><span> * </span><span style="color:#40a070">30</span><span style="color:#408080;font-style:italic">;</span><span>
</span>      return setTimeout(() =&gt; {
<!-- -->        console.error(
<!-- -->          `Process did not terminate within ${timeout}ms. Stopping now!`
<span>        )</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>        process.nextTick(</span><span style="color:#000080;font-weight:normal">process.exit</span><span>(</span><span style="color:#000080;font-weight:normal">1</span><span>))</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      }, timeout)</span><span style="color:#408080;font-style:italic">;</span><span>
</span>    }
<!-- -->
<!-- -->    // handle errors &amp; rejections
<span>    process.on(</span><span style="color:#219161">&quot;uncaughtException&quot;</span><span>, (</span><span style="color:#000080;font-weight:normal">error:</span><span> Error) =&gt; {
</span><span>      log(</span><span style="color:#000080;font-weight:normal">error.stack</span><span>, </span><span style="color:#219161">&quot;fatal&quot;</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      process.nextTick(</span><span style="color:#000080;font-weight:normal">process.exit</span><span>(</span><span style="color:#000080;font-weight:normal">1</span><span>))</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>    })</span><span style="color:#408080;font-style:italic">;</span><span>
</span>
<span>    process.on(</span><span style="color:#219161">&quot;unhandledRejection&quot;</span><span>, (</span><span style="color:#000080;font-weight:normal">rejection:</span><span> Error) =&gt; {
</span><span>      log(</span><span style="color:#000080;font-weight:normal">rejection.stack</span><span>, </span><span style="color:#219161">&quot;fatal&quot;</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      process.nextTick(</span><span style="color:#000080;font-weight:normal">process.exit</span><span>(</span><span style="color:#000080;font-weight:normal">1</span><span>))</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>    })</span><span style="color:#408080;font-style:italic">;</span><span>
</span>
<!-- -->    // handle signals
<span>    process.on(</span><span style="color:#219161">&quot;SIGINT&quot;</span><span>, async () =&gt; {
</span><span>      log(`[ SIGNAL ] - SIGINT`, </span><span style="color:#219161">&quot;notice&quot;</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      let timer = awaitHardStop()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      await this.stop()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      clearTimeout(</span><span style="color:#000080;font-weight:normal">timer</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>    })</span><span style="color:#408080;font-style:italic">;</span><span>
</span>
<span>    process.on(</span><span style="color:#219161">&quot;SIGTERM&quot;</span><span>, async () =&gt; {
</span><span>      log(`[ SIGNAL ] - SIGTERM`, </span><span style="color:#219161">&quot;notice&quot;</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      let timer = awaitHardStop()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      await this.stop()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      clearTimeout(</span><span style="color:#000080;font-weight:normal">timer</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>    })</span><span style="color:#408080;font-style:italic">;</span><span>
</span>
<span>    process.on(</span><span style="color:#219161">&quot;SIGUSR2&quot;</span><span>, async () =&gt; {
</span><span>      log(`[ SIGNAL ] - SIGUSR2`, </span><span style="color:#219161">&quot;notice&quot;</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      let timer = awaitHardStop()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      await this.restart()</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>      clearTimeout(</span><span style="color:#000080;font-weight:normal">timer</span><span>)</span><span style="color:#408080;font-style:italic">;</span><span>
</span><span>    })</span><span style="color:#408080;font-style:italic">;</span><span>
</span>  }
</code></pre><p>You can of course add custom handlers as well to handle additional signals. Note that the environment variable <code>ACTIONHERO_SHUTDOWN_TIMEOUT</code> can be used to change how long the process waits to shut down gracefully.</p></div><div class="d-none d-md-block col-md-3"><div style="height:0"><div style="padding-top:90px;position:sticky;top:0"><ul style="list-style-type:none;padding-left:0;margin-left:0"></ul></div></div></div></div><br/><div><a style="text-decoration:none" href="/tutorials"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Back to Tutorials</button></a></div></div><div class="d-none d-md-block col-md-3"></div></div></div><div style="background-color:#6E8898;color:#2F5266;font-weight:300;padding-top:100px;padding-bottom:100px"><div class="container"><div class="row"><div class="col-md-2"></div><div style="text-align:center;color:#FBF9E4;padding-bottom:100px" class="col-md-8"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Solutions</h1><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72"><span style="color:#FBF9E4">Actionhero was built from the ground up to include all the features you expect from a modern API framework.</span></h2></div><div class="col-md-2"></div></div><div class="row"><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-left:40px;padding-right:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Open Source</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>The Actionhero server is open source, under the Apache-2 license</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>Actionhero runs on Linux, OS X, and Windows</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>You always have access to the Actionhero team via<!-- --> <a href="/community">Slack and Github</a></p><br/><br/><div><a style="text-decoration:none" href="/downloads"><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Download</button></a></div></div></div><div class="d-lg-none col-md-4"><div style="width:100%;padding:20px;background-color:#2F5266;color:#FFFFFF;box-shadow:0px 2px 4px #003C51"><div style="text-align:center"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px"><span style="color:#FBF9E4">Premium Training &amp; Review</span></h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Audits</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div><div class="d-none d-lg-block col-md-4"><div style="width:125%;padding:40px;background-color:#2F5266;color:#FFFFFF;position:relative;top:-60px;box-shadow:0px 2px 4px #003C51;margin-left:-13%;margin-right:-5%;z-index:10"><div style="text-align:center;padding-bottom:10px"><img src="/static/images/dog.svg"/><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Premium Training &amp; Review</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We provide support for corporate &amp; nonprofit customers starting at a flat rate of $150/hr. Our services include:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>Remote training for your team</strong></li><li><strong>Code Reviews</strong></li><li><strong>Best Practices Workshops</strong></li><li><strong>Custom plugin &amp; Feature Development</strong></li></ul><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>We have packages appropriate for all company sizes. Contact us to learn more.</p><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div><div class="col-md-4"><div style="width:100%;padding-top:40px;padding-bottom:40px;padding-right:40px;padding-left:50px;background-color:#FBF9E4;box-shadow:0px 2px 4px #003C51"><div style="text-align:center;padding-bottom:10px"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px">Enterprise</h1></div><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><p>For larger customers in need of a support contract, we offer an enterprise plan including everything in the Premium plan plus:</p><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px"/><ul><li><strong>24/7 access to core members of the Actionhero Team</strong></li><li><strong>Emergency response packages</strong></li><li><strong>Deployment support</strong></li><li><strong>...and custom development against Actionhero’s core as needed.</strong></li></ul><br/><div><button style="font-family:Roboto, sans-serif;font-weight:300;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#E14E3A;border-color:#E14E3A;margin-top:20px;margin-bottom:20px;padding-top:15px;padding-bottom:15px;outline:none" type="button" class="btn btn-primary btn-block btn-lg">Contact Us</button></div></div></div></div></div></div></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300" class="container-fluid"><footer id="footer-container" style="background-color:#2F5266;color:#FBF9E4;font-family:Roboto, sans-serif;font-weight:200"><div class="container"><div style="padding-bottom:50px;padding-top:50px;padding-left:100px" class="row"><div class="col-md-12"><img src="/static/images/actionhero-logo-header-wordmark.svg"/></div></div><div style="padding-bottom:100px" class="row"><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/terms">Terms</a></p><p>Contact us at<!-- --> <a style="color:#FBF9E4;font-weight:500" href="mailto:hello@actionherojs.com">hello@actionherojs.com</a></p><p>You can contribute to this website<!-- --> <a style="color:#FBF9E4;font-weight:500" href="https://github.com/actionhero/www.actionherojs.com" target="_blank">here</a>.</p><p><a href="https://medium.com/tag/actionherojs/latest" target="_new" style="color:#FBF9E4">Blogs</a></p><p style="color:#FFFFFF;font-weight:bold">© 2020<!-- --> <!-- -->Actionhero</p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a style="color:#FBF9E4" href="/why">Why Actionhero</a></p><p><a style="color:#FBF9E4" href="/get-started">Get Started</a></p><p><a style="color:#FBF9E4" href="/key-concepts">Key Concepts</a></p><p><a href="https://docs.actionherojs.com" style="color:#FBF9E4">Documenation</a></p><p><a style="color:#FBF9E4" href="/solutions">Solutions</a></p><p><a style="color:#FBF9E4" href="/community">Community</a></p><p><a style="color:#FBF9E4" href="/downloads">Downloads</a></p></div></div><div class="col-md-4"><div style="padding-left:100px"><p><a href="https://www.npmjs.com/package/actionhero" target="_new" style="color:#FBF9E4">NPM</a></p><p><a href="https://twitter.com/actionherojs" target="_new" style="color:#FBF9E4">Twitter</a></p><p><a href="https://slack.actionherojs.com/" target="_new" style="color:#FBF9E4">Slack</a></p><p><a href="https://github.com/Actionhero/Actionhero" target="_new" style="color:#FBF9E4">Github</a></p><p><a href="https://actionherojs.threadless.com" target="_new" style="color:#FBF9E4">Shop</a></p></div></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"markdown":"## Server.ts\n\nActionhero v22 removes the built-in `actionhero start` and `actionhero start cluster` commands, and adds a single `server.ts` entrypoint for your applications. We are also removing support for `boot.ts|js`.\n\nFor years, Actionhero has shipped with a robust runtime solution, handling graceful restarts, clustering, and more... however. as the node.js ecosystem has matured, the community has:\n\n1. Created excellent process management tools, like [PM2](https://pm2.keymetrics.io/) which handle running and monitoring your processes, including integration with OS process managers\n2. Moved to serverless/PASS/Docker deployments which prefer to mange the running of the application directly.\n\nTo better integrate with the above, Actionhero will now run from a new `server.ts` file, which will be required in your project @ `/src/server.ts`:\n\n```ts\nimport { Process } from \"actionhero\";\n\n// load any custom code, configure the env, as needed\n\nasync function main() {\n  // create a new actionhero process\n  const app = new Process();\n\n  // handle unix signals and uncaught exceptions \u0026 rejections\n  app.registerProcessSignals();\n\n  // start the app!\n  // you can pass custom configuration to the process as needed\n  await app.start();\n}\n\nmain();\n```\n\nWhen developing, there is no change to your workflow:\n\n- `npm run dev` will continue to hot-compile your typescript code and run it.\n- `npm run build` will compile your TS into JS\n- `npm start` will now run your `./dist/server.js` instead of running `./node_modules/.bin/actoinhero`\n\nThis change should also make it easier to distribute your actionhero projects as you can modify a base config collection from this file, and you can use tools like [pkg](https://github.com/zeit/pkg) to compile your projects.\n\nNow that we have this single entrypoint for your applications, we no longer need `boot.js|ts`. You can now directly run any setup code you need, modify the environment, etc directly in `server.ts`.\n\n## The Actionhero Binary\n\nActionhero also includes an optional binary which can help you with lifecycle tasks, like generating a new project, actions, tasks, and more. The help for this binary is as follows:\n\n```\n--------------------------------------\nActionhero COMMAND \u003e\u003e help\n--------------------------------------\nActionhero - A multi-transport node.js API Server with integrated cluster capabilities and delayed tasks\n\nBinary options:\n\n* actions list\n* console\n* generate\n* generate action\n* generate cli\n* generate initializer\n* generate plugin\n* generate server\n* generate task\n* help\n* task enqueue\n* version\n\nDescriptions:\n\n* actions list\n  description: I will list the actions defined on this server\n\n* console\n  description: start an interactive REPL session with the api object in-scope\n\n* generate\n  description: will prepare an empty directory with a template Actionhero project\n\n* generate action\n  description: generate a new action\n  example: Actionhero generate action --name=[name] --description=[description]\n  inputs:\n    [name]\n    [description]\n      default: an Actionhero action\n\n* generate cli\n  description: generate a new cli command\n  example: Actionhero generate cli --name=[name]\n  inputs:\n    [name]\n    [description] (optional)\n      default: an Actionhero cli command\n    [example] (optional)\n      default: Actionhero command --option=yes\n\n* generate initializer\n  description: generate a new initializer\n  example: Actionhero generate initializer --name=[name] --loadPriority=[p] --startPriority=[p] --stopPriority=[p]\n  inputs:\n    [name]\n    [loadPriority]\n      default: 1000\n    [startPriority]\n      default: 1000\n    [stopPriority]\n      default: 1000\n\n* generate plugin\n  description: generate the structure of a new Actionhero plugin in an empty directory\n  example: Actionhero generate plugin\n\n* generate server\n  description: generate a new server\n  example: Actionhero generate server --name=[name]\n  inputs:\n    [name]\n\n* generate task\n  description: generate a new task\n  example: Actionhero generate task --name=[name] --description=[description] --scope=[scope] --frequency=[frequency]\n  inputs:\n    [name]\n    [queue]\n    [description]\n      default: an Actionhero task\n    [frequency]\n\n* help\n  description: get actionhero CLI help; will display this document\n\n* task enqueue\n  description: enqueue a defined task into your Actionhero cluster\n  example: Actionhero task enqueue --name=[taskName] --args=[JSON-formatted args]\n  inputs:\n    [name]\n    [args] (optional)\n    [params] (optional)\n\n* version\n  description: return the Actionhero version within this project\n```\n\n## Environments and Config\n\nBy default, Actionhero will use the settings found in the `exports.default` blocks in `/config/`. However, you can set environment-specific overrides or changes. Actionhero inspects `process.env.NODE_ENV` to load up runtime configuration overrides from `exports.#{env}` blocks in your configuration files. This is the recommended way to have separate settings for staging and production.\n\nThe load order of configs is:\n\n- default values in `/config`\n- environment-specific values in `/config`\n- options passed in to boot with `Actionhero.start({configChanges: configChanges})`\n\nYou can `{configChanges: {}}` to a new Actionhero.Process' `start` or `initialize` methods. This can be helpful when creating tests. When using CLI commands, you can also set `process.env.configChanges` or pass `--configChanges` on the command line. In these cases, `configChanges` should be stringified JSON.\n\n```ts\n// from ./config/namespace.js\nexport const DEFAULT = {\n  namespace: function(api) {\n    return {\n      enabled: true,\n      safe: false\n    };\n  }\n};\n\nexport const production = {\n  namespace: function(api) {\n    return {\n      safe: true\n    };\n  }\n};\n```\n\nIn the example above, we are defining `config.namespace.enabled` and `config.namespace.safe`. In all environments (NODE_ENV) `config.namespace.enabled = true` Only in production would `config.namespace.safe = true`, it is `false` everywhere else.\n\n## Signals\n\nIf your `server.ts` has used `app.registerProcessSignals()`, you should be ready to handle the most common unix signals:\n\n```ts\n  /**\n   * Register listeners for process signals and uncaught exceptions \u0026 rejections.\n   * Try to gracefully shut down when signaled to do so\n   */\n  registerProcessSignals() {\n    function awaitHardStop() {\n      const timeout = process.env.ACTIONHERO_SHUTDOWN_TIMEOUT\n        ? parseInt(process.env.ACTIONHERO_SHUTDOWN_TIMEOUT)\n        : 1000 * 30;\n      return setTimeout(() =\u003e {\n        console.error(\n          `Process did not terminate within ${timeout}ms. Stopping now!`\n        );\n        process.nextTick(process.exit(1));\n      }, timeout);\n    }\n\n    // handle errors \u0026 rejections\n    process.on(\"uncaughtException\", (error: Error) =\u003e {\n      log(error.stack, \"fatal\");\n      process.nextTick(process.exit(1));\n    });\n\n    process.on(\"unhandledRejection\", (rejection: Error) =\u003e {\n      log(rejection.stack, \"fatal\");\n      process.nextTick(process.exit(1));\n    });\n\n    // handle signals\n    process.on(\"SIGINT\", async () =\u003e {\n      log(`[ SIGNAL ] - SIGINT`, \"notice\");\n      let timer = awaitHardStop();\n      await this.stop();\n      clearTimeout(timer);\n    });\n\n    process.on(\"SIGTERM\", async () =\u003e {\n      log(`[ SIGNAL ] - SIGTERM`, \"notice\");\n      let timer = awaitHardStop();\n      await this.stop();\n      clearTimeout(timer);\n    });\n\n    process.on(\"SIGUSR2\", async () =\u003e {\n      log(`[ SIGNAL ] - SIGUSR2`, \"notice\");\n      let timer = awaitHardStop();\n      await this.restart();\n      clearTimeout(timer);\n    });\n  }\n```\n\nYou can of course add custom handlers as well to handle additional signals. Note that the environment variable `ACTIONHERO_SHUTDOWN_TIMEOUT` can be used to change how long the process waits to shut down gracefully.\n","name":"running-actionhero"}},"page":"/tutorials/[name]","query":{"name":"running-actionhero"},"buildId":"Bi8zX94g88TeljxT54m8H","nextExport":true,"isFallback":false,"gip":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-a2ec81a3b359d83082c2.js"></script><script src="/_next/static/chunks/main-34725f5a99cb2b2b6f00.js" async=""></script><script src="/_next/static/chunks/webpack-488dc228921f1fdbc0e7.js" async=""></script><script src="/_next/static/chunks/framework.a5d4ffe593e18b49243e.js" async=""></script><script src="/_next/static/chunks/commons.94d1ccb9dee116719961.js" async=""></script><script src="/_next/static/chunks/pages/_app-7d0481f4467570ea8ca6.js" async=""></script><script src="/_next/static/chunks/dd05285286c593a0e6da2f584467d9517f5816b2.be19a4f843a12596b98d.js" async=""></script><script src="/_next/static/chunks/27270cb085e17e8e99404fc0284c05b5fb1bb558.1923d1b6e48e3134e628.js" async=""></script><script src="/_next/static/chunks/e75431a1bdcb89b14e100a4a4bb0858c3732af66.b4fa2937edb4092f8c40.js" async=""></script><script src="/_next/static/chunks/pages/tutorials/%5Bname%5D-e4f5bf03c6c5960f3180.js" async=""></script><script src="/_next/static/Bi8zX94g88TeljxT54m8H/_buildManifest.js" async=""></script><script src="/_next/static/Bi8zX94g88TeljxT54m8H/_ssgManifest.js" async=""></script></body></html>